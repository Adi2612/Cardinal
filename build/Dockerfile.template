# syntax = docker/dockerfile:experimental

FROM gcr.io/deeplearning-platform-release/base-cpu

WORKDIR /src

RUN conda create -n cardinal-env python=3.7 pip

COPY requirements.txt /src/

COPY cardinal-requirements.txt /src/

RUN /bin/bash -c "source activate cardinal-env"

RUN --mount=type=cache,target=/root/.cache/pip pip install -r requirements.txt

RUN --mount=type=cache,target=/root/.cache/pip pip install -r cardinal-requirements.txt

COPY . /src/

{{EXPOSE}}

{{CMD}}